{"version":3,"sources":["webpack:///./src/views/Video.vue?a344","webpack:///./src/assets/happy3.mp4","webpack:///./src/views/Video.vue","webpack:///./src/views/Video.vue?d0cc","webpack:///./src/assets/angry3.mp4","webpack:///./src/assets/angry2.mp4","webpack:///./src/assets/happy2.mp4","webpack:///./src/assets/neutral2.mp4","webpack:///./src/assets/wow2.mp4","webpack:///./src/assets/wow3.mp4"],"names":["module","exports","id","ref","class","autoplay","playsinline","runModel","to","board","item","key","src","chosenemoji","emoji","loop","name","data","setup","initParams","modelUri","option","minConfidence","constraints","video","width","min","ideal","max","height","frameRate","facingMode","videoEl","canvasEl","mood","feel","happy","surprised","angry","neutral","value","withFaceExpressions","result","prediction_string","picker","setTimeout","chosenNumber","Math","floor","random","length","obj","top_prediction","maxVal","str","p","expressions","initModel","ssdMobilenetv1","loadFromUri","faceExpressionNet","startStream","navigator","mediaDevices","getUserMedia","stream","srcObject","console","error","message","methods","render","__scopeId"],"mappings":"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","file":"js/Video.b03ce478.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Video.vue?vue&type=style&index=0&id=5cfbd85c&scoped=true&lang=css\"","module.exports = __webpack_public_path__ + \"media/happy3.9b134e41.mp4\";","<template>\r\n  <div id=\"Video\">\r\n            <video\r\n    id=\"webcam\"\r\n      ref=\"videoEl\"\r\n      autoplay=\"true\"\r\n      playsinline\r\n      @loadedmetadata=\"runModel\"\r\n    />\r\n    <canvas ref=\"canvasEl\" />\r\n     <div class=\"menu\">\r\n        <router-link to=\"/\">\r\n         <i class=\"material-icons nav__icon\">home</i>\r\n        </router-link>\r\n      </div>\r\n    <div class=\"button\">\r\n      <router-link to=\"/Mood\">Mood</router-link>\r\n    </div>\r\n        <li class=\"board\">\r\n      <ul\r\n        v-for=\"(item,key) in board\"\r\n        :key=\"key\"\r\n      >\r\n        {{ key }} ï¼š {{ item }}\r\n      </ul>\r\n    </li>\r\n    <div class=\"animate\">\r\n      <video :src=\"chosenemoji.emoji\" autoplay loop></video>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as faceAPI from 'face-api.js'\r\nimport { onMounted, reactive, ref } from 'vue'\r\nexport default {\r\n  name: 'Video',\r\n  data() {\r\n    return {\r\n      \r\n    };\r\n  },\r\n  setup () {\r\n    const initParams = reactive({\r\n      modelUri: './models',\r\n      option: new faceAPI.SsdMobilenetv1Options({ minConfidence: 0.5 })\r\n    })\r\n    const constraints = reactive({\r\n      video: {\r\n        width: {\r\n          min: 320,\r\n          ideal: 1280,\r\n          max: 1920\r\n        },\r\n        height: {\r\n          min: 240,\r\n          ideal: 720,\r\n          max: 1080\r\n        },\r\n        frameRate: {\r\n          min: 15,\r\n          ideal: 30,\r\n          max: 60\r\n        },\r\n        facingMode: 'environment'\r\n      }\r\n    })\r\n    const videoEl = ref(null)\r\n    const canvasEl = ref(null)\r\n    const board = reactive({\r\n      mood: ''\r\n    })\r\n    const feel = reactive({\r\n      happy: [require('@/assets/happy1.mp4'), require('@/assets/happy2.mp4'), require('@/assets/happy3.mp4')],\r\n      surprised: [require('@/assets/wow1.mp4'), require('@/assets/wow2.mp4'), require('@/assets/wow3.mp4')],\r\n      angry: [require('@/assets/angry.mp4'), require('@/assets/angry2.mp4'), require('@/assets/angry3.mp4')],\r\n      neutral: [require('@/assets/neutral.mp4'), require('@/assets/neutral2.mp4')]\r\n    })\r\n    let chosenemoji = reactive({\r\n      emoji: ''\r\n    })\r\n    /**\r\n     * caculate fps for detection\r\n     * @function\r\n     * @param number\r\n     */\r\n    // const updateTimeStats = (timeInMs) => {\r\n    //   forwardTimes = [timeInMs].concat(forwardTimes).slice(0, 30)\r\n    //   // const avgTimeInMs = forwardTimes.reduce((total, t) => total + t) / forwardTimes.length\r\n    //   // board.fps = faceAPI.utils.round(1000 / avgTimeInMs)\r\n    // }\r\n\r\n    /**\r\n       * @function\r\n       * @description detect input video\r\n       */\r\n    const runModel = async () => {\r\n      // const beforeDetect = Date.now()\r\n      const result = await faceAPI.detectAllFaces(videoEl.value, initParams.option).withFaceExpressions()\r\n      // updateTimeStats(Date.now() - beforeDetect)\r\n      if (result) {\r\n        // const dims = faceAPI.matchDimensions(canvasEl.value, videoEl.value, true)\r\n        // const resizeResults = faceAPI.resizeResults(result, dims)\r\n        board.mood = prediction_string(result[0])\r\n        chosenemoji.emoji = picker(board.mood)\r\n        // faceAPI.draw.drawDetections(canvasEl.value, resizeResults)\r\n        // faceAPI.draw.drawFaceExpressions(canvasEl.value, resizeResults)\r\n      }\r\n      setTimeout(() => runModel(),3000)\r\n    }\r\n\r\nconst picker = (value) => {\r\n  var data, chosenNumber\r\n    if (value === 'neutral' || value === ''){\r\n    data = feel.neutral\r\n    chosenNumber = Math.floor(Math.random() * data.length);\r\n    chosenemoji.emoji = data[chosenNumber]; \r\n      } \r\n    if (value === 'happy' || value === 'disgusted'){\r\n    data = feel.happy\r\n    chosenNumber = Math.floor(Math.random() * data.length);\r\n    chosenemoji.emoji = data[chosenNumber]; \r\n      }\r\n    if (value === 'surprised' || value === 'fearful'){\r\n    data = feel.surprised\r\n    chosenNumber = Math.floor(Math.random() * data.length);\r\n    chosenemoji.emoji = data[chosenNumber]; \r\n      }\r\n    if (value === 'angry' || value === 'sad'){\r\n    data = feel.angry\r\n    chosenNumber = Math.floor(Math.random() * data.length);\r\n    chosenemoji.emoji = data[chosenNumber]; \r\n      }\r\n    \r\n    return  chosenemoji.emoji;\r\n  \r\n  }\r\n\r\n   const prediction_string = (obj) => {\r\n  let top_prediction = 'neutral';\r\n  let maxVal = 0;\r\n  var str = top_prediction;\r\n  \r\n \r\n  if (!obj) return str;\r\n \r\n  obj = obj.expressions;\r\n  for (var p in obj) {\r\n    \r\n      if (obj[p] > maxVal) {\r\n        maxVal = obj[p];\r\n        top_prediction = p;\r\n        if (p === 'happy' || p === 'disgusted'){\r\n        top_prediction=\"happy\"\r\n        }\r\n        if (p === 'surprised' || p === 'fearful'){\r\n        top_prediction=\"surprised\"\r\n        }\r\n        if (p === 'angry' || p === 'sad'){\r\n        top_prediction=\"angry\"\r\n        }\r\n      }\r\n  }\r\n \r\n  return  top_prediction;\r\n}\r\n\r\n\r\n    onMounted(() => {\r\n      /**\r\n       * @function\r\n       * @description load the trained model\r\n       */\r\n      const initModel = async () => {\r\n        await faceAPI.nets.ssdMobilenetv1.loadFromUri(initParams.modelUri)\r\n        await faceAPI.nets.faceExpressionNet.loadFromUri(initParams.modelUri)\r\n      }\r\n\r\n      /**\r\n       * startup webcam\r\n       * @function\r\n       */\r\n      const startStream = async () => {\r\n        try {\r\n          const stream = await navigator.mediaDevices.getUserMedia(constraints)\r\n          videoEl.value.srcObject = stream\r\n        } catch (error) {\r\n          console.error(error.message)\r\n        }\r\n      }\r\n\r\n      initModel()\r\n      startStream()\r\n    })\r\n\r\n    return {\r\n      videoEl,\r\n      canvasEl,\r\n      runModel,\r\n      board,\r\n      chosenemoji\r\n    }\r\n  },\r\n  methods:{\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#Video{\r\n  background-color: #fdc002;\r\n  position: relative;\r\n  height: 100vh;\r\n}\r\nvideo{\r\n  width: 100%;\r\n}\r\n#webcam {\r\n  /* display: none; */\r\n    position: absolute;\r\n    object-fit: cover;\r\n    top: 10vh;\r\n    left: 1%;\r\n    width: 150px;\r\n    height: 150px;\r\n  }\r\n.animate{\r\nbackground-color: #fdc002;\r\n}\r\n.board{\r\n    font-size: 20px;\r\n    list-style: none;\r\n    z-index: 1;\r\n    text-align: left;\r\n    height: 50px;\r\n    position: absolute;\r\n    top: 20px;\r\n    left: 1%;\r\n  }\r\n\r\n.button{\r\n  z-index: 2;\r\n  position: absolute;\r\n  top: 10px;\r\n  right: 10px;\r\n  border: 1px white solid;\r\n  border-radius: 25px;\r\n  background-color: #fff;\r\n  padding: 10px;\r\n}\r\n.button a{\r\n  color: #000;\r\n  text-decoration: none;\r\n  font-size: 20px;\r\n  font-weight: 500;\r\n}\r\n\r\n.menu{\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  width: 100px;\r\n  position: absolute;\r\n  top: 1vh;\r\n  right: 3%;\r\n  z-index: 2;\r\n}\r\n.menu .nav__icon{\r\n  color: #fff;\r\n  font-size: 50px;\r\n}\r\n\r\ncanvas {\r\n  position: absolute;\r\n}\r\n@media (max-width:1024px) {\r\n#Video{\r\n  background-color: #fdc002;\r\n  position: relative;\r\n  height: 100vh;\r\n}\r\n#webcam {\r\n    position: absolute;\r\n    object-fit: cover;\r\n    top: 10vh;\r\n    left: 30px;\r\n    width: 150px;\r\n    height: 150px;\r\n  }\r\n.board{\r\n    font-size: 20px;\r\n    list-style: none;\r\n    z-index: 1;\r\n    text-align: left;\r\n    height: 50px;\r\n    position: absolute;\r\n    top: 5vh;\r\n    left: 30px;\r\n  }\r\n\r\n.menu{\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  width: 120px;\r\n  position: absolute;\r\n  top: 1vh;\r\n  right: 20px;\r\n  z-index: 2;\r\n}\r\n.nav__icon{\r\n  color: #fff;\r\n  font-size: 50px;\r\n}\r\n\r\n}\r\n</style>\r\n","import { render } from \"./Video.vue?vue&type=template&id=5cfbd85c&scoped=true\"\nimport script from \"./Video.vue?vue&type=script&lang=js\"\nexport * from \"./Video.vue?vue&type=script&lang=js\"\n\nimport \"./Video.vue?vue&type=style&index=0&id=5cfbd85c&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-5cfbd85c\"\n\nexport default script","module.exports = __webpack_public_path__ + \"media/angry3.bf183b38.mp4\";","module.exports = __webpack_public_path__ + \"media/angry2.a484fce2.mp4\";","module.exports = __webpack_public_path__ + \"media/happy2.f1bd217b.mp4\";","module.exports = __webpack_public_path__ + \"media/neutral2.eae6d9c7.mp4\";","module.exports = __webpack_public_path__ + \"media/wow2.5367ea53.mp4\";","module.exports = __webpack_public_path__ + \"media/wow3.cf56ca40.mp4\";"],"sourceRoot":""}